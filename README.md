
# **A repository for the multi-state diel occupancy model (MSDOM) and associated manuscripts:** 

### River, K, Fidino, M, Farris, ZJ, Murphy, A, Magle, SB, and Gerber, BD. Rethinking habitat occupancy modeling and the role of diel activity in an anthropogenic world. In Review.
---


**This repository includes 5 number of subfolders: Chicago coyote, Data Processing, JAGS, Makira Fosa2, and RNP Fosa**
1) The Chicago coyote folder includes data, R scripts, and plots specific to case study on coyotes that uses the dynamic MSDOM.
2) The Data Procesing folder includes R scripts and example data on how to .....
3) The JAGS folder includes JAGS models for the static and dynamic MSDOM, including the full, reduced, and null parameterizations.
4) The Makira Fosa2 folder includes fosa data from Makira Natural Park and R scripts for fitting the static MSDOM, including model comparison using CPO.
5) The RNP Fosa folder includes fosa data from Ranomafana National Park and R scripts for fitting the MSDOM, including model comparison using CPO.

**sourcer.R:** This is a utility script to load packages (and install them if you do not have them) and sources **utility_script.R**, **plotting_utility.R**, and **prepare_data.R** in that order.

**utility_script.R:** This script holds custom functions. `package_load()` takes a vector of package names and loads them. If a package is not available it will install it. `HDIofMCMC()` calculates the highest density interval of a posterior. `inits()` is a function that generates initial values for `JAGS`. `initsimp()` is similar to `inits`, except for a null model. `calc_cpo()` calcualtes the conditional predictive ordinate of each data point and then summarises them for model selection.

**plotting_utility.R:** has plotting functions for **figure_2_through_4_script.R**

**prepare_data.R:** is a script that prepares the species detection data and covariates for a Bayesian analysis in `JAGS`.

**fit_grp_model.R:**  This is the only script you need to open and run to fit the data through the models. It'll also calcualte and store the CPO scores of each model, plus save MCMC outputs into a results folder (which will be created in your working directory if it does not exist).

**summarise_results.R:** This script summarises the output generated by **fit_grp_model.R**. If a `./results_summary` folder does not exist this script will create one and spit out 95% credible intervals of paramters into there.

**figure_1_script.R:** This creates figure_1 of the manuscript. It assumes there is a plot sub-folder.

**figure_2_through_4_script.R:** This creates species-specific plots of average occupancy and response to urbanization from the best fit model of each species. I then used imagemagick via the console to combine images, add species pictures, and format to the appropriate size.

**figure_5_script.R:** This creates a rough draft of figure 5, which was touched up a little bit in inkscape.


---

<div align="center"><img width="150" height="auto" src="raccoon.jpg" alt="A silhouette of a raccoon." /></div>

<div align="center"> <h3>Model</h3> </div>

---

**This repository has 1 JAGS model that we used for our analysis. It is located in the jags_models sub-folder of the working directory:**

**city_mean_occupancy.R:** This is a single-species hierarchical occupancy model with among-city effects.

---

<div align="center"><img width="150" height="auto" src="coyote.jpg" alt="A silhouette of a coyote." /></div>

<div align="center"> <h3>Data</h3> </div>
